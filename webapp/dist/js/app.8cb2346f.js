(function(t){function e(e){for(var s,n,l=e[0],i=e[1],c=e[2],d=0,p=[];d<l.length;d++)n=l[d],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&p.push(r[n][0]),r[n]=0;for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],s=!0,l=1;l<a.length;l++){var i=a[l];0!==r[i]&&(s=!1)}s&&(o.splice(e--,1),t=n(n.s=a[0]))}return t}var s={},r={app:0},o=[];function n(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=s,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(a,s,function(e){return t[e]}.bind(null,s));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=i;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0120":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),r=function(){var t=this,e=t._self._c;return e("div",[e("div",{attrs:{id:"app"}},[t.isLoggedIn()?e("nav",{staticClass:"navbar navbar-expand-md navbar-dark fixed-top bg-dark"},[e("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v("Task List")]),t._m(0),e("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarCollapse"}},[t._m(1),e("ul",{staticClass:"nav navbar-nav navbar-right mr-4 text-light"},[e("li",{staticClass:"nav-item mr-4"},[t._v(" Hello, "+t._s(t.username)+" ")]),e("li",{staticClass:"nav-item"},[e("router-link",{attrs:{to:"/logout"}},[t._v("Sign out")])],1)])])],1):t._e(),e("router-view")],1)])},o=[function(){var t=this,e=t._self._c;return e("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation"}},[e("span",{staticClass:"navbar-toggler-icon"})])},function(){var t=this,e=t._self._c;return e("ul",{staticClass:"navbar-nav mr-auto"},[e("li",{staticClass:"nav-item"})])}],n=a("1232"),l=a("bc3a");const i="authToken";function c(t,e){return console.log("Getting token for "+t),l["a"].post("/token",{username:t,password:e}).then(t=>{console.log("response:"+t.data),u(t.data)}).catch(t=>console.log("Axios err: ",t))}function u(t){console.log("Setting token: "+t),l["a"].defaults.headers.common["Authorization"]="Bearer "+t,localStorage.setItem(i,t);let e=h(t);console.log("sub: "+e)}function d(){return localStorage.getItem(i)}function p(){console.log("Clearing auth token"),l["a"].defaults.headers.common["Authorization"]="",localStorage.removeItem(i)}function g(){let t=d(),e=!!t&&!f(t);return console.log("isLoggedIn: "+e),e}function m(){if(g()){let t=Object(n["a"])(d());return t.sub?t.sub:null}}function h(t){let e=Object(n["a"])(t);return e.sub?e.sub:null}function v(t){let e=Object(n["a"])(t);if(!e.exp)return null;let a=new Date(0);return a.setUTCSeconds(e.exp),a}function f(t){let e=v(t);return e<new Date}var b={data(){return{username:""}},methods:{isLoggedIn(){let t=g();return t&&(this.username=m()),t}}},C=b,w=(a("a448"),a("2877")),y=Object(w["a"])(C,r,o,!1,null,null,null),_=y.exports,k=a("8c4f"),x=function(){var t=this,e=t._self._c;return e("main",{attrs:{role:"main"}},[e("div",{staticClass:"container bg-light p-3 mt-4 mb-1"},[""!=t.error?e("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e("span",{staticClass:"mr-2"},[e("svg",{staticClass:"bi bi-x-circle",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}}),e("path",{attrs:{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"}})])]),t._v(t._s(t.error)+" ")]):t._e(),e("form",{on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"taskTitleInput"}},[t._v("Title")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control",attrs:{type:"text",id:"taskTitleInput",placeholder:"Title",required:""},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"taskBodyInput"}},[t._v("Body")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.body,expression:"body"}],staticClass:"form-control",attrs:{id:"taskBodyInput",placeholder:"Body",rows:"3",required:""},domProps:{value:t.body},on:{input:function(e){e.target.composing||(t.body=e.target.value)}}})]),e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"taskBodyInput"}},[t._v("Due date")]),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dueDate,expression:"dueDate"}],attrs:{id:"datepickerduedate",name:"datepickerduedate",type:"date"},domProps:{value:t.dueDate},on:{input:function(e){e.target.composing||(t.dueDate=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",on:{click:t.createTask}},[t._v(" Create task ")])])])]),e("div",{staticClass:"container bg-light p-3"},[e("h2",[t._v("My Tasks")]),t.loading?e("div",[e("p",[t._v("Loading...")])]):e("div",t._l(t.tasks,(function(a){return e("div",{key:a.id},[e("div",{staticClass:"card w-100"},[e("div",{staticClass:"card-body"},[e("button",{staticClass:"btn btn-outline-secondary float-right",on:{click:function(e){return t.deleteTask(a.id)}}},[t._v(" Delete ")]),e("h5",{staticClass:"card-title"},[t._v(t._s(a.title))]),e("small",{staticClass:"text-secondary"},[t._v("Created: "+t._s(a.createdAt))]),a.dueDate?e("small",{staticClass:"text-secondary"},[t._v(" / Due: "+t._s(a.dueDate))]):t._e(),e("p",{staticClass:"card-text"},[t._v(" "+t._s(a.body)+" ")]),a.progress?e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",staticStyle:{width:"100%"},attrs:{role:"progressbar"}},[t._v(" "+t._s(a.progress)+" ")])]):t._e(),a.upload?e("div",{staticClass:"text-secondary mb-2",attrs:{href:"#"}},[t._v(" 1 attachment ")]):e("div",{staticClass:"mb-2"},[t._v(" Attachment: "),e("input",{ref:"file",refInFor:!0,attrs:{type:"file"},on:{change:t.fileChanged}}),e("button",{staticClass:"btn btn-outline-secondary btn-sm",on:{click:function(e){return t.submitFile(a)}}},[t._v(" Upload ")])]),a.labels?e("small",{staticClass:"text-secondary"},[t._v("Detected labels:")]):t._e(),t._l(a.labels,(function(a){return e("div",{key:a.id},[e("span",{staticClass:"badge badge-info float-left mr-1 mb-1"},[t._v(t._s(a))])])}))],2)])])})),0)])])},T=[];function O(t){return new Promise(e=>setTimeout(e,t))}var S={name:"home",data(){return{error:"",loading:!0,title:null,body:null,dueDate:null,tasks:[],attachment:null,uploadUrl:null}},mounted(){this.getTasks()},methods:{async createTask(){this.error="";let t=d();console.log("Creating task"),console.log("Title:"+this.title),console.log("Body:"+this.body),this.title&&this.body?(await l["a"].post("/tasks",{title:this.title,body:this.body,dueDate:this.dueDate},{headers:{Authorization:"Bearer "+t}}).then(t=>{console.log(JSON.stringify(t.data,null,2))}).catch(t=>{console.log(t),this.error="Error creating task: "+t.message}),await this.getTasks()):console.log("Title or body empty")},async deleteTask(t){t=t.split("#")[1],console.log("Deleting task "+t),this.error="";let e=d();await l["a"].delete("/tasks/"+t,{headers:{Authorization:"Bearer "+e}}).then(()=>{console.log("Deleted task "+t)}).catch(t=>{console.log(t),this.error="Error deleting task: "+t.message}),await this.getTasks()},async getTasks(){console.log("Getting tasks"),this.error="";let t=d();this.loading=!0,await l["a"].get("/tasks",{headers:{Authorization:"Bearer "+t}}).then(t=>{console.log(JSON.stringify(t.data,null,2)),this.tasks=t.data,this.tasks=this.tasks.sort((t,e)=>t.createdAt<e.createdAt?1:-1)}).catch(t=>{console.log(t),this.error="Error getting tasks: "+t.message}),this.loading=!1},fileChanged(t){var e=t.target.files||t.dataTransfer.files;e.length&&(console.log(e[0]),this.attachment=e[0])},async getSignedUrl(t){console.log("Getting signed URL");let e=d();const a={headers:{Authorization:"Bearer "+e},params:{filename:this.attachment.name,filetype:this.attachment.type,taskId:t}},s=await l["a"].get("/signedUrl",a);return new URL(s.data.uploadURL)},async submitFile(t){this.attachment||alert("Please select a file to upload.");const e=t.id.split("#")[1],a=await this.getSignedUrl(e),r={headers:{"Content-Type":this.attachment.type}};console.log("config: "+JSON.stringify(r)),console.log("Uploading to S3: "+a);var o=l["a"].create();delete o.defaults.headers.common["Authorization"];const n=await o.put(a,this.attachment,r);console.log(n.status),s["a"].set(t,"progress","Detecting labels..."),await O(5e3),await this.getTasks()}}},A=S,D=Object(w["a"])(A,x,T,!1,null,null,null),z=D.exports,P=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-signin text-center mt-5"},[e("svg",{staticClass:"bi bi-shield-lock mb-2",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"}}),e("path",{attrs:{d:"M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415z"}})]),e("h1",{staticClass:"h3 mb-3 font-weight-normal"},[t._v("Please sign in")]),""!=t.error?e("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[t._v(" "+t._s(t.error)+" ")]):t._e(),e("div",{staticClass:"form-group"},[e("label",{staticClass:"sr-only",attrs:{for:"username"}},[t._v("Username")]),e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("svg",{staticClass:"bi bi-person-fill",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"}})])])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text",name:"username",placeholder:"Username",required:"",autofocus:""},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"sr-only",attrs:{for:"username"}},[t._v("Password")]),e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("svg",{staticClass:"bi bi-shield-lock-fill",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M8 0c-.69 0-1.843.265-2.928.56-1.11.3-2.229.655-2.887.87a1.54 1.54 0 0 0-1.044 1.262c-.596 4.477.787 7.795 2.465 9.99a11.777 11.777 0 0 0 2.517 2.453c.386.273.744.482 1.048.625.28.132.581.24.829.24s.548-.108.829-.24a7.159 7.159 0 0 0 1.048-.625 11.775 11.775 0 0 0 2.517-2.453c1.678-2.195 3.061-5.513 2.465-9.99a1.541 1.541 0 0 0-1.044-1.263 62.467 62.467 0 0 0-2.887-.87C9.843.266 8.69 0 8 0zm0 5a1.5 1.5 0 0 1 .5 2.915l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99A1.5 1.5 0 0 1 8 5z"}})])])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",name:"password",placeholder:"Password",required:"",autofocus:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"submit"},on:{click:t.login}},[t._v(" Sign in ")])])])},j=[],B=(a("14d9"),{name:"login",data(){return{error:"",username:"",password:""}},methods:{async login(){try{this.error="",await c(this.username,this.password),this.$router.push("/")}catch(t){this.error=JSON.stringify(t)}}}}),L=B,I=(a("e9d0"),Object(w["a"])(L,P,j,!1,null,"70242443",null)),U=I.exports,M=function(){var t=this;t._self._c;return t._m(0)},N=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"about container bg-light p-3 rounded"},[e("h2",[t._v("About")]),t._v(" This is an about page. ")])}],J={},q=Object(w["a"])(J,M,N,!1,null,null,null),E=q.exports,R=function(){var t=this,e=t._self._c;return e("div",[e("center",[e("h1",[t._v("404 not found")]),e("h2",[t._v("it seems you're in the wrong page")])])],1)},F=[],G={},H=Object(w["a"])(G,R,F,!1,null,null,null),$=H.exports;s["a"].use(k["a"]);const K=new k["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:z},{path:"/login",name:"login",component:U,meta:{allowAnonymous:!0}},{path:"/logout",name:"Logout",beforeEnter(t,e,a){p(),a("/login")}},{path:"/about",name:"about",component:E},{path:"*",component:$}]});K.beforeEach((t,e,a)=>{"login"==t.name&&g()?(console.log("redirecting to /"),a({path:"/"})):t.meta.allowAnonymous||g()?(console.log("router next()"),a()):(console.log("redirecting to /login"),a({path:"/login",query:{redirect:t.fullPath}}))});var Q=K;s["a"].config.productionTip=!1,l["a"].defaults.baseURL="https://6op2hmih77.execute-api.us-west-2.amazonaws.com/v1",new s["a"]({router:Q,render:t=>t(_)}).$mount("#app")},a448:function(t,e,a){"use strict";a("0120")},c1aa:function(t,e,a){},e9d0:function(t,e,a){"use strict";a("c1aa")}});
//# sourceMappingURL=app.8cb2346f.js.map